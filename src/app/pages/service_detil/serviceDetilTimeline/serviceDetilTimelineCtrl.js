/** * Created by sorcerer on 2017/11/1. */(function () {    'use strict';    angular.module('BlurAdmin.pages.servicedetil')        .controller('serviceDetilTimelineCtrl', serviceDetilTimelineCtrl);    /** @ngInject */    function serviceDetilTimelineCtrl($scope,ReplicationController,$rootScope) {        var timelineBlocks = $('.cd-timeline-block'),            offset = 0.8;        //hide timeline blocks which are outside the viewport        hideBlocks(timelineBlocks, offset);        //on scolling, show/animate timeline blocks when enter the viewport        $(window).on('scroll', function () {            if (!window.requestAnimationFrame) {                setTimeout(function () {                    showBlocks(timelineBlocks, offset);                }, 100);            } else {                window.requestAnimationFrame(function () {                    showBlocks(timelineBlocks, offset);                });            }        });        function hideBlocks(blocks, offset) {            blocks.each(function () {                ( $(this).offset().top > $(window).scrollTop() + $(window).height() * offset ) && $(this).find('.cd-timeline-img, .cd-timeline-content').addClass('is-hidden');            });        }        function showBlocks(blocks, offset) {            blocks.each(function () {                ( $(this).offset().top <= $(window).scrollTop() + $(window).height() * offset && $(this).find('.cd-timeline-img').hasClass('is-hidden') ) && $(this).find('.cd-timeline-img, .cd-timeline-content').removeClass('is-hidden').addClass('bounce-in');            });        }        loadRcs($scope.dc.metadata.name)        function loadRcs(name) {            var labelSelector = 'openshift.io/deployment-config.name=' + name;            ReplicationController.get({                namespace: $rootScope.namespace,                labelSelector: labelSelector,                region:$rootScope.region            }, function (rcs) {                console.log('rcs', rcs);                angular.forEach(rcs.items, function (item,i) {                    //console.log("item.metadata.annotations['openshift.io/deployment.phase']", item.metadata.annotations['openshift.io/deployment.phase']);                    if (item.metadata.annotations['openshift.io/deployment.phase'] === 'New' ||item.metadata.annotations['openshift.io/deployment.phase'] === 'Pending' ||item.metadata.annotations['openshift.io/deployment.phase'] === 'Running') {                        rcs.items[i].image='Money-Increase';                    }else if(item.metadata.annotations['openshift.io/deployment.phase'] == 'Complete'){                        rcs.items[i].image='Checklist';                    }else {                        rcs.items[i].image='Vector';                    }                })                $scope.rcs=rcs;            }, function (res) {                //todo 错误处理            });        };    }})();